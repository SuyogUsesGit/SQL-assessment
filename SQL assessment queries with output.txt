-- QUERY 1 --

SOLUTION: select person_id,
   		case
   		when preferred_first_name is not null and preferred_first_name != '' then preferred_first_name
   		else first_name
   		end as 'REPORTING_NAME',
   		last_name, date_of_birth, hire_date, occupation
   		from person;

OUTPUT:

+-----------+----------------+-----------+---------------+------------+------------+
| person_id | REPORTING_NAME | last_name | date_of_birth | hire_date  | occupation |
+-----------+----------------+-----------+---------------+------------+------------+
|         1 | Tom            | Federer   | 1990-10-13    | 2000-04-06 | T          |
|         2 | Ron            | Miller    | 1991-10-13    | 2001-03-06 | R          |
|         3 | Max            | Henson    | 1992-10-13    | 2002-03-06 | M          |
|         4 | Jim            | Hawkings  | 1993-10-13    | 2003-03-06 | NULL       |
|         5 | Tim            | Jefferson | 1989-10-13    | 2003-03-06 | NULL       |
|         6 | Seth           | Rollings  | 1989-10-13    | 2021-04-01 | NULL       |
|         7 | Peter          | Smith     | 1989-10-13    | 2020-04-01 | NULL       |
|         8 | Jonas          | Jones     | 1989-10-13    | 2020-04-01 | NULL       |
+-----------+----------------+-----------+---------------+------------+------------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- QUERY 2 --

SOLUTION: select * from person where occupation is null;

OUTPUT: 

+-----------+------------+----------------------+-----------+---------------+------------+------------+
| person_id | first_name | preferred_first_name | last_name | date_of_birth | hire_date  | occupation |
+-----------+------------+----------------------+-----------+---------------+------------+------------+
|         4 | Jimmy      | Jim                  | Hawkings  | 1993-10-13    | 2003-03-06 | NULL       |
|         5 | Timothy    | Tim                  | Jefferson | 1989-10-13    | 2003-03-06 | NULL       |
|         6 | Seth       |                      | Rollings  | 1989-10-13    | 2021-04-01 | NULL       |
|         7 | Peter      |                      | Smith     | 1989-10-13    | 2020-04-01 | NULL       |
|         8 | Jonas      |                      | Jones     | 1989-10-13    | 2020-04-01 | NULL       |
+-----------+------------+----------------------+-----------+---------------+------------+------------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-- QUERY 3 --

SOLUTION: select * from person where date_of_birth < '1990-08-09';

OUTPUT: 

+-----------+------------+----------------------+-----------+---------------+------------+------------+
| person_id | first_name | preferred_first_name | last_name | date_of_birth | hire_date  | occupation |
+-----------+------------+----------------------+-----------+---------------+------------+------------+
|         5 | Timothy    | Tim                  | Jefferson | 1989-10-13    | 2003-03-06 | NULL       |
|         6 | Seth       |                      | Rollings  | 1989-10-13    | 2021-04-01 | NULL       |
|         7 | Peter      |                      | Smith     | 1989-10-13    | 2020-04-01 | NULL       |
|         8 | Jonas      |                      | Jones     | 1989-10-13    | 2020-04-01 | NULL       |
+-----------+------------+----------------------+-----------+---------------+------------+------------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-- QUERY 4 --

SOLUTION: select * from person where datediff(now(), hire_date) < 100;

OUTPUT: 

+-----------+------------+----------------------+-----------+---------------+------------+------------+
| person_id | first_name | preferred_first_name | last_name | date_of_birth | hire_date  | occupation |
+-----------+------------+----------------------+-----------+---------------+------------+------------+
|         6 | Seth       |                      | Rollings  | 1989-10-13    | 2021-04-01 | NULL       |
+-----------+------------+----------------------+-----------+---------------+------------+------------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



-- QUERY 5 --

SOLUTION: select person.person_id, first_name, preferred_first_name, last_name, date_of_birth, hire_date, occupation
		from person join address on person.person_id = address.person_id where address.address_type = 'HOME';

OUTPUT:

+-----------+------------+----------------------+-----------+---------------+------------+------------+
| person_id | first_name | preferred_first_name | last_name | date_of_birth | hire_date  | occupation |
+-----------+------------+----------------------+-----------+---------------+------------+------------+
|         4 | Jimmy      | Jim                  | Hawkings  | 1993-10-13    | 2003-03-06 | NULL       |
|         7 | Peter      |                      | Smith     | 1989-10-13    | 2020-04-01 | NULL       |
|         8 | Jonas      |                      | Jones     | 1989-10-13    | 2020-04-01 | NULL       |
+-----------+------------+----------------------+-----------+---------------+------------+------------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-- QUERY 6 --

SOLUTION: select person.person_id, first_name, preferred_first_name, last_name, date_of_birth, hire_date, occupation, 
		case 
		when address.address_type = 'BILL' then address.address_type
		else 'NONE'
		end as 'address_type' 
		from person join address on person.person_id = address.person_id;

OUTPUT:

+-----------+------------+----------------------+-----------+---------------+------------+------------+--------------+
| person_id | first_name | preferred_first_name | last_name | date_of_birth | hire_date  | occupation | address_type |
+-----------+------------+----------------------+-----------+---------------+------------+------------+--------------+
|         4 | Jimmy      | Jim                  | Hawkings  | 1993-10-13    | 2003-03-06 | NULL       | NONE         |
|         6 | Seth       |                      | Rollings  | 1989-10-13    | 2021-04-01 | NULL       | BILL         |
|         7 | Peter      |                      | Smith     | 1989-10-13    | 2020-04-01 | NULL       | BILL         |
|         7 | Peter      |                      | Smith     | 1989-10-13    | 2020-04-01 | NULL       | NONE         |
|         8 | Jonas      |                      | Jones     | 1989-10-13    | 2020-04-01 | NULL       | BILL         |
|         8 | Jonas      |                      | Jones     | 1989-10-13    | 2020-04-01 | NULL       | NONE         |
+-----------+------------+----------------------+-----------+---------------+------------+------------+--------------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-- QUERY 7 --

SOLUTION: select address_type, count(*) as count from address group by address_type;

OUTPUT:

+--------------+-------+
| address_type | count |
+--------------+-------+
| HOME         |     3 |
| BILL         |     3 |
+--------------+-------+

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


-- QUERY 8 --

SOLUTION: select last_name,
  	 	max(case when a.`address_type` = 'HOME' then a.street_line_1 end) home_address,
  		max(case when a.`address_type` = 'BILL' then a.street_line_1 end) billing_address
		from person p
		left join address a
  		on p.person_id= a.person_id
		group by p.person_id having count(a.person_id) > 1;

OUTPUT:

+-----------+------------------------------------+-----------------------------------------+
| last_name | home_address                       | billing_address                         |
+-----------+------------------------------------+-----------------------------------------+
| Smith     | 89 Lyon Circle, Clifton, VA 12345  | 25 Science Park, New Haven, CT 06511    |
| Jones     | 212 Maple Ave, Manassas, VA 22033  | 275 Winchester Ave, New Haven, CT 06511 |
+-----------+------------------------------------+-----------------------------------------+


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- QUERY 9 --

SOLUTION: update person set occupation = 'X' where person_id in (select person_id from address where address_type = 'BILL');


OUTPUT: Query OK, 3 rows affected (0.01 sec)
Rows matched: 3  Changed: 3  Warnings: 0

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
